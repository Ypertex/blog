<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=/ypertex.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat+Alternates:700,700i|Montserrat:400,400i,700,700i&display=swap"><link rel=stylesheet href=https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css><title>Working Around the JumpCloud Curl Error 22 · Ypertex Blog</title><link rel=apple-touch-icon sizes=57x57 href=/apple-touch-icon-57x57.png><link rel=apple-touch-icon sizes=60x60 href=/apple-touch-icon-60x60.png><link rel=apple-touch-icon sizes=72x72 href=/apple-touch-icon-72x72.png><link rel=apple-touch-icon sizes=76x76 href=/apple-touch-icon-76x76.png><link rel=apple-touch-icon sizes=114x114 href=/apple-touch-icon-114x114.png><link rel=apple-touch-icon sizes=120x120 href=/apple-touch-icon-120x120.png><link rel=apple-touch-icon sizes=144x144 href=/apple-touch-icon-144x144.png><link rel=apple-touch-icon sizes=152x152 href=/apple-touch-icon-152x152.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon-180x180.png><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/android-chrome-192x192.png sizes=192x192><meta name=msapplication-square70x70logo content="/smalltile.png"><meta name=msapplication-square150x150logo content="/mediumtile.png"><meta name=msapplication-wide310x150logo content="/widetile.png"><meta name=msapplication-square310x310logo content="/largetile.png"></head><body><header><nav class="navbar navbar-dark navbar-expand-md bg-dark"><div class=container><a class=navbar-brand href=/><svg viewBox="0 0 440 176" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;max-height:1rem"><g transform="matrix(1,0,0,1,-2574,-792)"><g id="Unprotected-primary-color-logogram-on-transparent-background" serif:id="Unprotected primary color logogram on transparent background" transform="matrix(1.12719,0,0,0.885774,2612.5,797.543)"><rect x="-34.159" y="-6.258" width="390.352" height="198.696" style="fill:none"/><clipPath id="_clip1"><rect x="-34.159" y="-6.258" width="390.352" height="198.696"/></clipPath><g clip-path="url(#_clip1)"><g transform="matrix(3.69565,0,0,4.16217,-240.2,-272.956)"><g transform="matrix(0.105625,-6.62507e-18,5.86335e-18,0.119347,45.1899,52.1434)"><path d="M1e2 5e2 3e2 3e2 1e2 1e2h67.274C252.258 1e2 333.761 133.757 393.857 193.846 397.723 197.712 4e2 199.988 4e2 199.988L5e2 99.976 699.976 1e2 8e2 200.024 9e2 1e2h2e2L9e2 3e2l2e2 2e2H1032.74C947.747 5e2 866.238 466.238 806.141 406.141 802.276 402.276 8e2 4e2 8e2 4e2L7e2 5e2H5e2L7e2 3e2 6e2 200.024 3e2 5e2H1e2z" style="fill:#0af"/></g><g transform="matrix(0.105625,0,0,0.119347,45.1899,40.2116)"><path d="M5e2 599.976l4e2-4e2L7e2 199.953 3e2 599.976H5e2z" style="fill:#0e1112;fill-opacity:.2"/></g></g></g></g></g></svg></a><div class="navbar-collapse collapse"><div class="navbar-nav mr-auto"><a href=/articles/ class="nav-item nav-link active">Articles</a>
<a href=/series/ class="nav-item nav-link">Series</a>
<a href=/tags/ class="nav-item nav-link">Tags</a></div><div class=navbar-nav><a href=https://www.linkedin.com/in/michaelschmidle class="nav-item nav-link" title=LinkedIn><i class="lab la-linkedin-in"></i></a><a href=https://twitter.com/MichaelSchmidle/ class="nav-item nav-link" title=Twitter><i class="lab la-twitter"></i></a><a href=https://github.com/MichaelSchmidle/ class="nav-item nav-link" title=GitHub><i class="lab la-github"></i></a></div></div></div></nav></header><main><section class="jumbotron jumbotron-fluid"><div class=container><h1 class=display-4>Working Around the JumpCloud Curl Error 22</h1><p class="text-muted mb-2"><small><i class="las la-upload"></i>&nbsp;Jun 21, 2017 · <i class="las la-stopwatch"></i>&nbsp;4min read</small></p><p class=mb-0><a href=/tags/tutorials/ class="badge badge-primary"><i class="las la-hashtag"></i>Tutorials</a></p></div></section><section class="yx-content container py-5"><div class=row><div class="col-xl-8 col-lg-10 mx-auto"><p class=lead>JumpCloud is a great tool to enable Single Sign On for whatever devices you have. Find out how to work around curl error 22 to keep using it on Linux.</p><hr><h2 id=introducing-jumpcloud>Introducing JumpCloud&nbsp;<a class=yx-anchor href=#introducing-jumpcloud><i class="las la-link"></i></a></h2><p>In case you have not yet heard about <a href=https://jumpcloud.com/>JumpCloud</a>: It is a cloud service that leverages user directories like Active Directory, Office 365, and G Suite (previously known as Google Apps) for <strong>Single Sign On in web apps and clients</strong>. My favorite feature of JumpCloud is its lightweight agent: Installing this little piece of software on Linux, MacOS and Windows clients and servers enables you and your directory users to log into these machines <em>with your directory credentials</em>. How awesome is that!</p><figure><picture>
<source media="(min-width: 1200px)" srcset=https://res.cloudinary.com/ypertex/image/upload/c_scale,dpr_auto,f_auto,q_auto,w_762/8a0f15ad-90b4-44b6-be9f-98261403072f><source media="(min-width: 992px)" srcset=https://res.cloudinary.com/ypertex/image/upload/c_scale,dpr_auto,f_auto,q_auto,w_802/8a0f15ad-90b4-44b6-be9f-98261403072f><source media="(min-width: 768px)" srcset=https://res.cloudinary.com/ypertex/image/upload/c_scale,dpr_auto,f_auto,q_auto,w_722/8a0f15ad-90b4-44b6-be9f-98261403072f><source media="(min-width: 576px)" srcset=https://res.cloudinary.com/ypertex/image/upload/c_scale,dpr_auto,f_auto,q_auto,w_542/8a0f15ad-90b4-44b6-be9f-98261403072f><img src=https://res.cloudinary.com/ypertex/image/upload/c_scale,dpr_auto,f_auto,q_auto,w_577/8a0f15ad-90b4-44b6-be9f-98261403072f alt class="shadow img-fluid"></picture><figcaption class="mt-3 col-md-8 mx-auto">Screenshot of the jumpcloud.com website, June 2017</figcaption></figure><p>No big deal, you say? Active Directory already provides this functionality, you say?—Not quite!</p><p>First of all, Active Directory comes with a price tag (there are affordable ways like the <a href=https://www.reddit.com/r/microsoftsoftwareswap/>Microsoft Softwareswap Reddit</a>, but still) while JumpCloud has a free version. Secondly, out of the box it only works on select Windows versions and the respective devices first need to be joined to your Active Directory Domain, controlled by servers usually inaccessible from outside your private network. So how do you quickly, within minutes and without prior preparation, join devices to your directory that are outside your network, i.e. virtual machines on the latest and greatest public cloud provider? With Active Directory, you cannot.</p><p>With JumpCloud you just install the agent, wait for a few seconds for the device to pop up in the JumpCloud console and then authorize your users and groups for that new device. Again a few seconds later, the device accepts logins from your users. All it requires is outbound port 443 (HTTPS) to be open for your devices, nothing more. There are some neat added security features: JumpCloud synchronizes not just user names and passwords between directory and devices—it also manages public SSH keys and offers Two Factor Authentication.</p><p>Not to mention: This service is <em>permanently</em> free for directories with up to ten users and an <em>unlimited</em> amount of devices.</p><blockquote><p>I rely on and do not want to miss the JumpCloud service to keep my little zoo of private virtual machines under control.</p></blockquote><h2 id=avoiding-curl-error-22-the-requested-url-returned-error-400-bad-request>Avoiding Curl Error 22 (the Requested URL Returned Error: 400 Bad Request)&nbsp;<a class=yx-anchor href=#avoiding-curl-error-22-the-requested-url-returned-error-400-bad-request><i class="las la-link"></i></a></h2><p>A few days ago, I started to receive above curl error 22 when deploying the JumpCloud agent on a new Linux virtual machine (generic Ubuntu Server 16.04.2 LTS). The error occurs mostly on a consistent basis, but apparently only in some environments and not in others. For example, it reliably works at <a href="http://www.vultr.com/?ref=6803870">Vultr</a> (affiliation link) and on my hypervisor on my desktop at home; but it continuously fails on my hypervisor at <a href=https://www.ovh.com/>OVH</a>. Results at <a href=https://www.scaleway.com/>Scaleway</a> were mixed: It worked in a first and failed in a second test on two different bare metal servers. I have still to pinpoint the exact issue but I could narrow the error down to the part in the install script that checks the local system time (the call of the URL <code>https://kickstart.jumpcloud.com/Time</code> apparently returns an HTTP status code <code>40x</code>). Anyway, the error says:</p><pre><code>curl: (22) The requested URL returned error: 400 Bad Request
</code></pre><p>Here is how to work around it: Instead of using the command provided by JumpCloud, use the following one (remember that I removed my connect key in the following command):</p><pre><code>curl --silent --show-error --header 'x-connect-key: [your individual connect key]' https://kickstart.jumpcloud.com/Kickstart &gt; jc.sh
</code></pre><p>Note the closing <code>> jc.sh</code> instead of the original <code>| sudo bash</code>. This way you only download the installer script and save it to the file <code>jc.sh</code> instead of executing it right away.</p><p>Then, open the downloaded installer script with your favorite editor, i.e. <code>nano jc.sh</code>. Prefix the following six lines in the script with the <code>#</code> character to comment these commands out so that they do not get executed when running the script:</p><pre><code>#logMessage 'Checking local system time...'
#localTime=&quot;$(date +%s)&quot;
#curlAgentWithoutCerts --data &quot;time=$localTime&quot; &quot;$timeUrl&quot;
#setTimeIfIncorrect &quot;$?&quot; &quot;Your system time seems inaccurate. Please ensure your system is set to the correct time by running ntpdate ('ntpdate -u pool.ntp.org') or verifying that ntpd is configured properly.&quot;
#localTime=&quot;$(date +%s)&quot;
#logMessage 'System time is accurate'
</code></pre><p>Save the file and exit the editor, then execute the script: <code>sudo bash jc.sh</code>. Et voilà, the script now runs without error and successfully installs the JumpCloud agent.</p><h2 id=conclusion>Conclusion&nbsp;<a class=yx-anchor href=#conclusion><i class="las la-link"></i></a></h2><p>JumpCloud allows you to use whatever physical or virtual Linux, MacOS or Windows clients and servers with <em>your centrally managed credentials</em>—anywhere you need it, whenever you need it.</p><p>Obviously, the curl error is quite annoying and the workaround requires a few extra manual steps. I hope JumpCloud fixes this issue soon. In the meantime, at least one can continue to deploy the JumpCloud agent on Linux machines.</p><p>If you have a better understanding of what the real issue is, please let me know via <a href=https://twitter.com/MichaelSchmidle>Twitter</a>. I will be happy to update this article accordingly. Thanks!</p><hr><div class="alert mx-n3 p-3 alert-primary">I am in no way affiliated with JumpCloud. The above praise is given as IT professional who employs JumpCloud for personal use.</div></div></div></section><section class="bg-light py-5"><div class=container><div class=row><div class="col-xl-8 col-lg-10 mx-auto"><div class="yx-heading mb-3">Share this article</div><div class="shadow card mx-n3"><div class=card-body><div class="row text-center"><div class=col><a class="btn btn-primary rounded-pill" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f&title=Working%20Around%20the%20JumpCloud%20Curl%20Error%2022&source=Ypertex%20Blog" title=LinkedIn onclick="window.open(this.href,'linkedin-share','width=550,height=550');return false;"><i class="lab la-linkedin-in"></i>&nbsp;LinkedIn</a></div><div class=col><a class="btn btn-primary rounded-pill" href="https://twitter.com/intent/tweet?text=Working%20Around%20the%20JumpCloud%20Curl%20Error%2022&url=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f" title=Twitter onclick="window.open(this.href,'twitter-share','width=550,height=550');return false;"><i class="lab la-twitter"></i>&nbsp;Twitter</a></div><div class=col><a class="btn btn-primary rounded-pill" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f" title=Facebook onclick="window.open(this.href,'facebook-share','width=550,height=550');return false;"><i class="lab la-facebook-f"></i>&nbsp;Facebook</a></div></div></div></div></div></div></div></section></main><footer class="bg-secondary text-light text-center"><div class="container py-5"><p><small><a href=/privacy/>Privacy Policy</a></small></p><p><svg viewBox="0 0 440 176" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;max-height:1rem"><g transform="matrix(1,0,0,1,-2574,-792)"><g id="Unprotected-primary-color-logogram-on-transparent-background" serif:id="Unprotected primary color logogram on transparent background" transform="matrix(1.12719,0,0,0.885774,2612.5,797.543)"><rect x="-34.159" y="-6.258" width="390.352" height="198.696" style="fill:none"/><clipPath id="_clip1"><rect x="-34.159" y="-6.258" width="390.352" height="198.696"/></clipPath><g clip-path="url(#_clip1)"><g transform="matrix(3.69565,0,0,4.16217,-240.2,-272.956)"><g transform="matrix(0.105625,-6.62507e-18,5.86335e-18,0.119347,45.1899,52.1434)"><path d="M1e2 5e2 3e2 3e2 1e2 1e2h67.274C252.258 1e2 333.761 133.757 393.857 193.846 397.723 197.712 4e2 199.988 4e2 199.988L5e2 99.976 699.976 1e2 8e2 200.024 9e2 1e2h2e2L9e2 3e2l2e2 2e2H1032.74C947.747 5e2 866.238 466.238 806.141 406.141 802.276 402.276 8e2 4e2 8e2 4e2L7e2 5e2H5e2L7e2 3e2 6e2 200.024 3e2 5e2H1e2z" style="fill:#0af"/></g><g transform="matrix(0.105625,0,0,0.119347,45.1899,40.2116)"><path d="M5e2 599.976l4e2-4e2L7e2 199.953 3e2 599.976H5e2z" style="fill:#0e1112;fill-opacity:.2"/></g></g></g></g></g></svg></p><p><small>Copyright © 2017-2020 Michael Schmidle<br>Original content released under the <a href=http://creativecommons.org/licenses/by/4.0/>CC BY 4.0 International</a> license</small></p></div></footer><script src=https://code.jquery.com/jquery-3.4.1.slim.min.js integrity=sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js integrity=sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6 crossorigin=anonymous></script></body></html>