<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Working Around the JumpCloud Curl Error 22 · Ypertex Blog</title>
    <meta name="description" content="Design. Technology. Future.">
    <meta name="generator" content="Hugo 0.37.1" />
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" type="text/css" href="/inhabitu.css">
</head>
<body>
    <header class="hero is-primary is-bold">
        <div class="hero-head">
            <nav class="navbar">
                <div class="container">
                    <div class="navbar-brand">
                        <a href="/" class="navbar-item is-active"><img class="inhabitu-navbar-logo" src="/media/logos/ypertex-logo-2017-01-inverted.png"> Ypertex Blog</a>
                    </div>
                    <div class="navbar-menu">
                        <div class="navbar-end">
                            <a class="navbar-item" href="https://twitter.com/Ypertex" title="Twitter"><i class="inhabitu-twitter icon"></i></a>
                            <a class="navbar-item" href="https://github.com/Ypertex/blog" title="Github"><i class="inhabitu-github icon"></i></a>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
        <div class="hero-body">
            <div class="container has-text-centered">
                
<h1 class="title is-1">Working Around the JumpCloud Curl Error 22</h1>

            </div>
        </div>
    </header>
    <main>
        
<section class="section">
    <div class="content container">
        <p class="is-size-5">JumpCloud is a great tool to enable Single Sign On for whatever devices you have. Find out how to work around curl error 22 to keep using it on Linux.</p>
<div class="level is-tablet">
    <div class="level-left">
        
        <div class="media level-item">
            <div class="media-left image is-32x32">
                <img class="inhabitu-author" src="/media/authors/michael-schmidle.jpg">
            </div>
            <small class="media-content">
                <strong><a href="/authors/michael-schmidle">Michael Schmidle</a></strong>
                <time class="heading" datetime="2017-06-21">June 21, 2017</time>
            </small>
        </div>
        
    </div>
    
    <div class="level-right">
        
        <a class="level-item tag is-rounded" href="/tags/it-recommendations"><span class="icon"><i class="inhabitu-tag"></i></span>IT Recommendations</a>
        
    </div>
    
</div>


<h2 id="introducing-jumpcloud">Introducing JumpCloud</h2>

<p>In case you have not yet heard about <a href="https://jumpcloud.com/">JumpCloud</a>: It is a cloud service that leverages user directories like Active Directory, Office 365, and G Suite (previously known as Google Apps) for <strong>Single Sign On in web apps and clients</strong>. My favorite feature of JumpCloud is its lightweight agent: Installing this little piece of software on Linux, MacOS and Windows clients and servers enables you and your directory users to log into these machines <em>with your directory credentials</em>. How awesome is that!</p>


<figure>
    
        <img src="/media/jumpcloud.com-2017-06.jpg" alt="Screenshot of the jumpcloud.com website in June 2017" />
    
    
    <figcaption>
        <p>
        Screenshot of the jumpcloud.com website in June 2017
        
            
        
        </p> 
    </figcaption>
    
</figure>


<p>No big deal, you say? Active Directory already provides this functionality, you say?—Not quite!</p>

<p>First of all, Active Directory comes with a price tag (there are affordable ways like the <a href="https://www.reddit.com/r/microsoftsoftwareswap/">Microsoft Softwareswap Reddit</a>, but still) while JumpCloud has a free version. Secondly, out of the box it only works on select Windows versions and the respective devices first need to be joined to your Active Directory Domain, controlled by servers usually inaccessible from outside your private network. So how do you quickly, within minutes and without prior preparation, join devices to your directory that are outside your network, i.e. virtual machines on the latest and greatest public cloud provider? With Active Directory, you cannot.</p>

<p>With JumpCloud you just install the agent, wait for a few seconds for the device to pop up in the JumpCloud console and then authorize your users and groups for that new device. Again a few seconds later, the device accepts logins from your users. All it requires is outbound port 443 (HTTPS) to be open for your devices, nothing more. There are some neat added security features: JumpCloud synchronizes not just user names and passwords between directory and devices—it also manages public SSH keys and offers Two Factor Authentication.</p>

<p>Not to mention: This service is <em>permanently</em> free for directories with up to ten users and an <em>unlimited</em> amount of devices.</p>

<blockquote>
<p>I rely on and do not want to miss the JumpCloud service to keep my little zoo of private virtual machines under control.</p>
</blockquote>

<h2 id="avoiding-curl-error-22-the-requested-url-returned-error-400-bad-request">Avoiding Curl Error 22 (the Requested URL Returned Error: 400 Bad Request)</h2>

<p>A few days ago, I started to receive above curl error 22 when deploying the JumpCloud agent on a new Linux virtual machine (generic Ubuntu Server 16.04.2 LTS). The error occurs mostly on a consistent basis, but apparently only in some environments and not in others. For example, it reliably works at <a href="http://www.vultr.com/?ref=6803870">Vultr</a> <small>(affiliation link)</small> and on my hypervisor on my desktop at home; but it continuously fails on my hypervisor at <a href="https://www.ovh.com/">OVH</a>. Results at <a href="https://www.scaleway.com/">Scaleway</a> were mixed: It worked in a first and failed in a second test on two different bare metal servers. I have still to pinpoint the exact issue but I could narrow the error down to the part in the install script that checks the local system time (the call of the URL <code>https://kickstart.jumpcloud.com/Time</code> apparently returns an HTTP status code <code>40x</code>). Anyway, the error says:</p>

<pre><code>curl: (22) The requested URL returned error: 400 Bad Request
</code></pre>

<p>Here is how to work around it: Instead of using the command provided by JumpCloud, use the following one (remember that I removed my connect key in the following command):</p>

<pre><code>curl --silent --show-error --header 'x-connect-key: [your individual connect key]' https://kickstart.jumpcloud.com/Kickstart &gt; jc.sh
</code></pre>

<p>Note the closing <code>&gt; jc.sh</code> instead of the original <code>| sudo bash</code>. This way you only download the installer script and save it to the file <code>jc.sh</code> instead of executing it right away.</p>

<p>Then, open the downloaded installer script with your favorite editor, i.e. <code>nano jc.sh</code>. Prefix the following six lines in the script with the <code>#</code> character to comment these commands out so that they do not get executed when running the script:</p>

<pre><code>#logMessage 'Checking local system time...'
#localTime=&quot;$(date +%s)&quot;
#curlAgentWithoutCerts --data &quot;time=$localTime&quot; &quot;$timeUrl&quot;
#setTimeIfIncorrect &quot;$?&quot; &quot;Your system time seems inaccurate. Please ensure your system is set to the correct time by running ntpdate ('ntpdate -u pool.ntp.org') or verifying that ntpd is configured properly.&quot;
#localTime=&quot;$(date +%s)&quot;
#logMessage 'System time is accurate'
</code></pre>

<p>Save the file and exit the editor, then execute the script: <code>sudo bash jc.sh</code>. Et voilà, the script now runs without error and successfully installs the JumpCloud agent.</p>

<h2 id="conclusion">Conclusion</h2>

<p>JumpCloud allows you to use whatever physical or virtual Linux, MacOS or Windows clients and servers with *your centrally managed credentials*—anywhere you need it, whenever you need it.</p>

<p>Obviously, the curl error is quite annoying and the workaround requires a few extra manual steps. I hope JumpCloud fixes this issue soon. In the meantime, at least one can continue to deploy the JumpCloud agent on Linux machines.</p>

<p>If you have a better understanding of what the real issue is, please let me know via <a href="https://twitter.com/MichaelSchmidle">Twitter</a>. I will be happy to update this article accordingly. Thanks!</p>

<hr />

<div class="message is-info">
    <h6 class="message-header">Note<i class="inhabitu-info icon"></i></h6>
    <div class="message-body">
        <p>I am in no way affiliated with JumpCloud. The above praise is given as IT professional who employs JumpCloud for personal use.</p>
    </div>
</div>

    </div>
</section>
<section class="inhabitu-emphasize section">
    <div class="container">
        <span class="heading">Share this article</span>
        <div class="inhabitu-overflow box">
            <div class="level is-mobile">
                <div class="level-item">
                    <a class="tag icon is-large is-primary is-rounded" href="https://twitter.com/intent/tweet?text=working-around-the-jumpcloud-curl-error-22&amp;url=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f" title="Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><i class="inhabitu-twitter"></i></a>
                </div>
                <div class="level-item">
                    <a class="tag icon is-large is-primary is-rounded" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f&amp;title=working-around-the-jumpcloud-curl-error-22&amp;source={@blog.title}" title="LinkedIn" onclick="window.open(this.href, 'linkedin-share', 'width=490,height=530');return false;"><i class="inhabitu-linkedin"></i></a>
                </div>
                <div class="level-item">
                    <a class="tag icon is-large is-primary is-rounded" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f" title="Facebook" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"><i class="inhabitu-facebook"></i></a>
                </div>
                <div class="level-item">
                    <a class="tag icon is-large is-primary is-rounded" href="https://plus.google.com/share?url=https%3a%2f%2fblog.ypertex.com%2farticles%2fjumpcloud-curl-error-22%2f" title="Google+" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;"><i class="inhabitu-google"></i></a>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="section">
    <div class="content container">
        
        
        
        <span class="heading">Previous article</span>
        <article>
    <h1 class="title is-3"><a href="/articles/the-making-of-the-ypertex-logo/">The Making of the Ypertex Logo</a></h1>
    <p class="content">The approach behind the creation of the Ypertex logo—and the similarities between visual designs (like logos) and conceptual designs (like IT solutions). <small class="is-size-7"><strong><a href="/articles/the-making-of-the-ypertex-logo/">Continue reading</a></strong></small></p>
    <div class="level is-tablet">
    <div class="level-left">
        
        <div class="media level-item">
            <div class="media-left image is-32x32">
                <img class="inhabitu-author" src="/media/authors/michael-schmidle.jpg">
            </div>
            <small class="media-content">
                <strong><a href="/authors/michael-schmidle">Michael Schmidle</a></strong>
                <time class="heading" datetime="2017-05-17">May 17, 2017</time>
            </small>
        </div>
        
    </div>
    
    <div class="level-right">
        
        <a class="level-item tag is-rounded" href="/tags/design"><span class="icon"><i class="inhabitu-tag"></i></span>Design</a>
        
        <a class="level-item tag is-rounded" href="/tags/on-a-personal-note"><span class="icon"><i class="inhabitu-tag"></i></span>On a Personal Note</a>
        
    </div>
    
</div>
</article>
        
    </div>
</section>


    </main>
    <footer class="footer">
        <div class="content container has-text-centered">
            <div class="columns is-centered">
                
                <div class="column is-narrow">
                    <a href="https://twitter.com/Ypertex"><i class="inhabitu-twitter icon"></i>Twitter</a>
                </div>
                
                
                <div class="column is-narrow">
                    <a href="https://github.com/Ypertex/blog"><i class="inhabitu-github icon"></i>Github</a>
                </div>
                
                <div class="column is-narrow">
                    <a href="/index.xml" title="RSS"><i class="inhabitu-rss icon"></i>RSS</a>
                </div>
            </div>
            <p class="is-size-7">Copyright © 2017 <a href="/">Ypertex Blog</a> · Some rights reserved<br>
                Original content released under the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License (CC BY 4.0)</a></p>
        </div>
    </footer>
</body>
</html>